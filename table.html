<!doctype html>
<html lang="en">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Professors at BU \n</title>
  </head>
  <body>
    <h1>Professors</h1>
    <br> 

    <table class="table">
        <thead>
          <tr>
            <th data-column="tFname" data-order="asc">First </th>
            <th data-column="tLname" data-order="asc">Last </th>
            <th data-column="tDept" data-order="asc">Department </th>
            <th data-column="overall_rating" data-order="asc">Rating </th>
            <th data-column="tNumRatings" data-order="asc">NumRatings </th>
          </tr>
        </thead>
        <tbody id = "myTable">
          
        </tbody>
      </table>

      
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  </body>
  <script>
    var myArray




    myArray = {"professors":[{"tDept":"Engineering","tSid":"124","institution_name":"Boston University","tFname":"Ousama","tMiddlename":"M","tLname":"Aamar","tid":2009364,"tNumRatings":5,"rating_class":"average","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"3.2"},{"tDept":"Music","tSid":"124","institution_name":"Boston University","tFname":"Brett","tMiddlename":"","tLname":"Abagana","tid":801149,"tNumRatings":7,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"4.5"},{"tDept":"Biology","tSid":"124","institution_name":"Boston University","tFname":"Maria","tMiddlename":"","tLname":"Abate","tid":90603,"tNumRatings":39,"rating_class":"average","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"3.0"},{"tDept":"Economics","tSid":"124","institution_name":"Boston University","tFname":"Siddiq","tMiddlename":"","tLname":"Abdullah","tid":1323610,"tNumRatings":22,"rating_class":"poor","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"2.2"},{"tDept":"Music","tSid":"124","institution_name":"Boston University","tFname":"Mari√©","tMiddlename":"","tLname":"Abe","tid":2019410,"tNumRatings":3,"rating_class":"poor","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"2.0"},{"tDept":"Religion","tSid":"124","institution_name":"Boston University","tFname":"Wande","tMiddlename":"","tLname":"Abimbola","tid":67975,"tNumRatings":17,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"3.9"},{"tDept":"Social Work","tSid":"124","institution_name":"Boston University","tFname":"Millan","tMiddlename":"","tLname":"Abinader","tid":2298852,"tNumRatings":3,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"3.7"},{"tDept":"English","tSid":"124","institution_name":"Boston University","tFname":"Rahad","tMiddlename":"","tLname":"Abir","tid":2591997,"tNumRatings":0,"rating_class":"zero","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"N/A"},{"tDept":"Biomedical","tSid":"124","institution_name":"Boston University","tFname":"Carmela","tMiddlename":"","tLname":"Abraham","tid":2161369,"tNumRatings":0,"rating_class":"zero","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"N/A"},{"tDept":"Social Work","tSid":"124","institution_name":"Boston University","tFname":"Gina","tMiddlename":"","tLname":"Abrams","tid":2637994,"tNumRatings":1,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"5.0"},{"tDept":"Chemistry","tSid":"124","institution_name":"Boston University","tFname":"Binyomin","tMiddlename":"","tLname":"Abrams","tid":1209405,"tNumRatings":173,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"4.3"},{"tDept":"Architecture","tSid":"124","institution_name":"Boston University","tFname":"Daniel","tMiddlename":"","tLname":"Abramson","tid":2518453,"tNumRatings":4,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"3.8"},{"tDept":"Arabic","tSid":"124","institution_name":"Boston University","tFname":"Amani","tMiddlename":"","tLname":"Abu Shakra","tid":1707738,"tNumRatings":0,"rating_class":"zero","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"N/A"},{"tDept":"Arts amp Administration","tSid":"124","institution_name":"Boston University","tFname":"Lafranco","tMiddlename":"","tLname":"Aceti","tid":2342024,"tNumRatings":0,"rating_class":"zero","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"N/A"},{"tDept":"Economics","tSid":"124","institution_name":"Boston University","tFname":"Calvin","tMiddlename":"","tLname":"Ackley","tid":2391306,"tNumRatings":0,"rating_class":"zero","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"N/A"},{"tDept":"Art History","tSid":"124","institution_name":"Boston University","tFname":"Kiernan","tMiddlename":"","tLname":"Acquisto","tid":2695902,"tNumRatings":1,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"5.0"},{"tDept":"English","tSid":"124","institution_name":"Boston University","tFname":"Allison","tMiddlename":"","tLname":"Adair","tid":86790,"tNumRatings":109,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"4.4"},{"tDept":"Languages","tSid":"124","institution_name":"Boston University","tFname":"Nicole","tMiddlename":"","tLname":"Adamowicz","tid":915954,"tNumRatings":21,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"4.8"},{"tDept":"Biology","tSid":"124","institution_name":"Boston University","tFname":"Kenneth","tMiddlename":"","tLname":"Adams","tid":1481331,"tNumRatings":20,"rating_class":"good","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"4.8"},{"tDept":"Law","tSid":"124","institution_name":"Boston University","tFname":"Lara","tMiddlename":"","tLname":"Adamsons","tid":1867831,"tNumRatings":2,"rating_class":"average","contentType":"TEACHER","categoryType":"PROFESSOR","overall_rating":"3.2"}],"searchResultsTotal":3304,"remaining":3284,"type":"alphabetical"}
    buildTable(myArray)

    // $.ajax({
    //   method: 'GET',
    //   url: "https://www.ratemyprofessors.com/filter/professor/?&page=1&filter=teacherlastname_sort_s+asc&query=*%3A*&queryoption=TEACHER&queryBy=schoolId&sid=124",
    //   success:function(response){
    //     var pages = Math.ceil((response.remaining+20)/20)
    //     for(var j=1; j<=pages; j++){
    //       grabPage(j)
    //     }
    //   }
    // })

        function grabPage(i){
          $.ajax({
            method: 'GET',
            url: "https://www.ratemyprofessors.com/filter/professor/?&page="+String(i)+"&filter=teacherlastname_sort_s+asc&query=*%3A*&queryoption=TEACHER&queryBy=schoolId&sid=124",
            success:function(response){
                myArray=response
                buildTable(myArray)
            }
        })

        }

        function buildTable(data){
            var table = document.getElementById('myTable')
            table.innerHTML="";
            
            for(var i = 0; i < data.professors.length; i++){
                var row = `<tr>
                        <td>${data.professors[i].tFname}</td>
                        <td>${data.professors[i].tLname}</td>
                        <td>${data.professors[i].tDept}</td>
                        <td>${data.professors[i].overall_rating}</td>
                        <td>${data.professors[i].tNumRatings}</td>
                    </tr>`
                table.innerHTML += row
            }
        }

        $('th').on('click', function(){
          var cols = document.getElementsByTagName('th')
          for(var i=0; i<cols.length; i++){
            cols[i].innerHTML=cols[i].innerHTML.substring(0, cols[i].innerHTML.length-1)+" "
          }
          console.log(cols[0].innerHTML.substring(0, cols[0].innerHTML.length-1)+" ")

          var column = $(this).data('column')
          var order = $(this).data('order')
          var text = $(this).html()
          text = text.substring(0,text.length-1)

          if(order=='asc'){
            $(this).data('order', "desc")
            myArray.professors = myArray.professors.sort((a,b) => a[column]<b[column] ? 1:-1)
            
            text += '&#9650'
          }

          else{
            $(this).data('order', "asc")
            myArray.professors = myArray.professors.sort((a,b) => a[column]>b[column] ? 1:-1)
            text += '&#9660'
          }
        
          $(this).html(text)
          buildTable(myArray)
          
        })

</script>
</html>